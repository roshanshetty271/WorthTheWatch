# AI-Generated Authentication Security Checklist

A comprehensive security audit checklist for authentication systems generated by AI tools (ChatGPT, Claude, Copilot, etc.)

## Overview

AI code generators often produce functional authentication code that passes basic tests but fails security best practices. This checklist helps you identify and fix common vulnerabilities.

---

## üî¥ Critical Security Issues

### 1. Password Storage

**‚ùå Common AI Mistakes:**
```javascript
// NEVER do this
if (password === user.password) {
  // Login successful
}

// Or this
const hashedPassword = md5(password);
```

**‚úÖ Correct Implementation:**
```javascript
const bcrypt = require('bcrypt');
const saltRounds = 12;

// Hashing
const hashedPassword = await bcrypt.hash(password, saltRounds);

// Verification
const isValid = await bcrypt.compare(password, user.hashedPassword);
```

**Requirements:**
- [ ] Use bcrypt, argon2, or scrypt (NOT md5, sha1, or sha256)
- [ ] Minimum 10 salt rounds for bcrypt (12+ recommended)
- [ ] Never store plaintext passwords
- [ ] Never log passwords (even in development)

---

### 2. Session Management

**‚ùå Common AI Mistakes:**
```javascript
// Vulnerable to XSS attacks
localStorage.setItem('token', jwtToken);
localStorage.setItem('userId', user.id);
```

**‚úÖ Correct Implementation:**
```javascript
// Server-side
res.cookie('token', jwtToken, {
  httpOnly: true,
  secure: true, // HTTPS only
  sameSite: 'strict',
  maxAge: 900000 // 15 minutes
});
```

**Requirements:**
- [ ] Use httpOnly cookies (prevents XSS access)
- [ ] Set secure flag (HTTPS only)
- [ ] Set sameSite attribute (CSRF protection)
- [ ] Implement proper session expiration
- [ ] Clear sessions on logout
- [ ] Invalidate sessions on password change

---

### 3. Rate Limiting

**‚ùå Common AI Mistakes:**
```javascript
// No rate limiting at all
app.post('/login', async (req, res) => {
  // Direct login attempt
});
```

**‚úÖ Correct Implementation:**
```javascript
const rateLimit = require('express-rate-limit');

const loginLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 5, // 5 attempts
  message: 'Too many login attempts, please try again later',
  standardHeaders: true,
  legacyHeaders: false,
});

app.post('/login', loginLimiter, async (req, res) => {
  // Login logic
});
```

**Requirements:**
- [ ] Limit login attempts (5 per 15 minutes recommended)
- [ ] Limit registration attempts
- [ ] Limit password reset requests
- [ ] Consider progressive delays after failed attempts
- [ ] Track by IP and/or username
- [ ] Implement CAPTCHA after multiple failures

---

### 4. JWT/Token Security

**‚ùå Common AI Mistakes:**
```javascript
// No expiration
const token = jwt.sign({ userId: user.id }, SECRET_KEY);

// Weak secret
const SECRET_KEY = 'mysecret';

// Storing sensitive data
const token = jwt.sign({ 
  userId: user.id, 
  password: user.password,
  creditCard: user.creditCard 
}, SECRET_KEY);
```

**‚úÖ Correct Implementation:**
```javascript
// Access token (short-lived)
const accessToken = jwt.sign(
  { userId: user.id, role: user.role },
  process.env.ACCESS_TOKEN_SECRET,
  { expiresIn: '15m' }
);

// Refresh token (longer-lived)
const refreshToken = jwt.sign(
  { userId: user.id },
  process.env.REFRESH_TOKEN_SECRET,
  { expiresIn: '7d' }
);
```

**Requirements:**
- [ ] Short-lived access tokens (15 minutes max)
- [ ] Implement refresh token mechanism
- [ ] Use strong, random secrets (256-bit minimum)
- [ ] Store secrets in environment variables
- [ ] Never include sensitive data in tokens
- [ ] Implement token blacklist/revocation
- [ ] Verify token on every protected route

---

### 5. Input Validation

**‚ùå Common AI Mistakes:**
```javascript
// No validation
app.post('/register', async (req, res) => {
  const { email, password } = req.body;
  // Direct database insertion
});
```

**‚úÖ Correct Implementation:**
```javascript
const validator = require('validator');

// Email validation
if (!validator.isEmail(email)) {
  return res.status(400).json({ error: 'Invalid email format' });
}

// Password strength
const passwordSchema = {
  minLength: 12,
  minLowercase: 1,
  minUppercase: 1,
  minNumbers: 1,
  minSymbols: 1
};

// SQL Injection prevention
const sanitizedEmail = validator.escape(email);

// XSS prevention
const sanitizedName = validator.escape(name);
```

**Requirements:**
- [ ] Validate email format
- [ ] Enforce password strength (min 12 chars, mixed case, numbers, symbols)
- [ ] Sanitize all inputs to prevent XSS
- [ ] Use parameterized queries to prevent SQL injection
- [ ] Validate data types and lengths
- [ ] Whitelist allowed characters
- [ ] Reject suspicious patterns

---

## üü° Important Security Practices

### 6. HTTPS/TLS

**Requirements:**
- [ ] Enforce HTTPS in production
- [ ] Redirect HTTP to HTTPS
- [ ] Use valid SSL certificates
- [ ] Implement HSTS headers
- [ ] Disable insecure TLS versions

---

### 7. Password Reset

**‚ùå Common AI Mistakes:**
```javascript
// Sending password in email
emailService.send({
  to: user.email,
  subject: 'Your password',
  body: `Your password is: ${user.password}`
});
```

**‚úÖ Correct Implementation:**
```javascript
const crypto = require('crypto');

// Generate secure token
const resetToken = crypto.randomBytes(32).toString('hex');
const resetTokenHash = crypto
  .createHash('sha256')
  .update(resetToken)
  .digest('hex');

// Store hashed token with expiration
user.resetToken = resetTokenHash;
user.resetTokenExpires = Date.now() + 3600000; // 1 hour

// Send link (not password)
const resetUrl = `https://yoursite.com/reset/${resetToken}`;
```

**Requirements:**
- [ ] Never send passwords via email
- [ ] Use cryptographically random tokens
- [ ] Hash reset tokens before storing
- [ ] Expire tokens (1 hour recommended)
- [ ] Invalidate token after use
- [ ] Require email verification
- [ ] Log all password reset attempts

---

### 8. Multi-Factor Authentication (MFA)

**Requirements:**
- [ ] Implement TOTP (Time-based One-Time Password)
- [ ] Support authenticator apps (Google Authenticator, Authy)
- [ ] Provide backup codes
- [ ] Allow SMS fallback (with warnings about SIM swapping)
- [ ] Require MFA for sensitive actions
- [ ] Store MFA secrets encrypted

---

### 9. Account Security

**Requirements:**
- [ ] Implement account lockout after failed attempts
- [ ] Send notifications for new logins
- [ ] Log authentication events
- [ ] Allow users to view active sessions
- [ ] Provide session revocation
- [ ] Implement "remember this device"
- [ ] Detect suspicious login patterns

---

### 10. Database Security

**Requirements:**
- [ ] Use parameterized queries/prepared statements
- [ ] Implement principle of least privilege
- [ ] Encrypt sensitive data at rest
- [ ] Regular database backups
- [ ] Separate database credentials per environment
- [ ] Never commit credentials to version control

---

## üü¢ Additional Best Practices

### 11. Error Handling

**‚ùå Don't:**
```javascript
catch (error) {
  res.status(500).json({ 
    error: error.message,
    stack: error.stack,
    query: sqlQuery
  });
}
```

**‚úÖ Do:**
```javascript
catch (error) {
  logger.error(error); // Log internally
  res.status(500).json({ 
    error: 'An error occurred during authentication'
  });
}
```

**Requirements:**
- [ ] Don't leak sensitive information in error messages
- [ ] Use generic error messages for authentication failures
- [ ] Log errors securely on the server
- [ ] Don't reveal whether username or password was incorrect

---

### 12. Security Headers

**Requirements:**
- [ ] Content-Security-Policy
- [ ] X-Frame-Options: DENY
- [ ] X-Content-Type-Options: nosniff
- [ ] Strict-Transport-Security
- [ ] X-XSS-Protection (legacy browsers)
```javascript
// Using Helmet.js
const helmet = require('helmet');
app.use(helmet());
```

---

### 13. Dependency Security

**Requirements:**
- [ ] Regularly update dependencies
- [ ] Use `npm audit` or `yarn audit`
- [ ] Implement Dependabot or Snyk
- [ ] Review security advisories
- [ ] Pin dependency versions in production

---

### 14. Environment Variables

**Requirements:**
- [ ] Never hardcode secrets
- [ ] Use .env files (gitignored)
- [ ] Different secrets per environment
- [ ] Rotate secrets regularly
- [ ] Use secret management services (AWS Secrets Manager, etc.)

---

## üîç Testing Checklist

- [ ] Test with invalid credentials
- [ ] Test with SQL injection payloads
- [ ] Test with XSS payloads
- [ ] Test rate limiting
- [ ] Test token expiration
- [ ] Test session management
- [ ] Test password reset flow
- [ ] Test CSRF protection
- [ ] Use OWASP ZAP or Burp Suite
- [ ] Perform penetration testing

---

## üìö Resources

- [OWASP Authentication Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [JWT Best Practices](https://tools.ietf.org/html/rfc8725)
- [NIST Password Guidelines](https://pages.nist.gov/800-63-3/sp800-63b.html)

---

## ü§ù Contributing

Found something missing? Have suggestions? Feel free to fork this gist and share your improvements!

---

**Last Updated:** January 2026

**License:** CC0 1.0 Universal - Public Domain